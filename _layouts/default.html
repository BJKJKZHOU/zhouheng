<!doctype html>
<html>
  {% include head.html %}
  <body>
    <div class="container">
      {% include header.html %}
      <!-- 在导航栏下方添加隐形参考线 -->
      <div class="reference-line"></div>
      <div class="content-wrapper">
        {{ content }}
      </div>
      {% include footer.html %}
    </div>
    
    <!-- 添加滚动检测脚本 -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const contentWrapper = document.querySelector('.content-wrapper');
        const referenceLine = document.querySelector('.reference-line');
        
        function checkScrollPosition() {
          // 获取屏幕高度
          const screenHeight = window.innerHeight;
          // 计算滚动阈值
          const threshold1 = screenHeight * 0.4; // 2/5 = 40%
          const threshold2 = screenHeight * 0.6; // 3/5 = 60%
          
          // 获取内容区域相对于视窗的位置
          const rect = contentWrapper.getBoundingClientRect();
          const scrollDistance = -rect.top; // 向上滚动的距离
          
          let blurValue = 4; // 默认模糊强度4px
          
          if (scrollDistance > threshold2) {
            // 超过3/5屏幕区域：模糊8px
            blurValue = 8;
          } else if (scrollDistance > threshold1) {
            // 在2/5到3/5之间：平滑过渡从6px到8px
            const progress = (scrollDistance - threshold1) / (threshold2 - threshold1);
            blurValue = 6 + (2 * progress); // 从6px线性过渡到8px
          } else if (scrollDistance > 0) {
            // 在0到2/5之间：平滑过渡从4px到6px
            const progress = scrollDistance / threshold1;
            blurValue = 4 + (2 * progress); // 从4px线性过渡到6px
          }
          
          // 应用动态模糊值
          contentWrapper.style.setProperty('--dynamic-blur', `${blurValue}px`);
        }
        
        // 监听滚动事件
        window.addEventListener('scroll', checkScrollPosition);
        
        // 初始检查
        checkScrollPosition();
      });
    </script>
  </body>
</html>